{% extends "../layout/dashboard.layout.jinja2" %}

{% block contentDashboard %}

  <div class="navbar">
    <h2 align="center">Topology Detail</h2>
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <div class="nav-collapse collapse">
          <ul class="nav">
            {% if request.user.role == 'admin' %}
            <li>
              <a href="{{ request.route_url('topologiesAction', action='autonomousSystem', id_topology = topology.id) }}"> Autonomous System </a>
            </li>
            <li>
              <a href="{{ request.route_url('topologiesAction', action='link', id_topology = topology.id) }}">Link</a>
            </li>
            <li>
              <a href="{{ request.route_url('topologiesAction', action='prefix', id_topology = topology.id) }}">BGP Prefix</a>
            </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class=" {{ css_class }} ">
    <p> {{ message }} </p>
  </div>

  <div id="aum" class="container-fluid">
    <div class="row-fluid">
      <div class="span12">
        <h3 align="center">Autonomous Systems: {{ topology.topology }}</h3>
      </div>
    </div>

    <div class="row-fluid">
      <div class="span12">
         <ul class="nav nav-tabs">
          {% for t1 in range(tabs + 1) %}
            {% if t1 == 0 %}
              {% if tabs == 0 %}
                <li class="active"><a data-toggle="tab" href="#tab{{ t1 }}">1</a></li>
              {% else %}
                <li class="active"><a data-toggle="tab" href="#tab{{ t1 }}">1</a></li>
                {% for t2 in range(tabs) %}
                  {% if t2 + 1 == tabs %}
                    <li><a data-toggle="tab" href="#tab{{ t2 + 1 }}">{{ t2 + 2 }}</a></li>
                  {% else %}
                    <li><a data-toggle="tab" href="#tab{{ t2 + 1 }}">{{ t2 + 2 }}</a></li>
                  {% endif %}
                {% endfor %}
              {% endif %}
            {% endif %}
          {% endfor %}
        </ul>

        <div class="tab-content">
          {% set accordion_range = namespace(value=10) %}
          {% set begin_accordion = namespace(value=0) %}
          {% set end_accordion = namespace(value=1000) %}
          {% for tab in range(tabs + 1) %}
            <div id="tab{{ tab }}" class="tab-pane fade {{ 'in active' if tab == 0 }}">
              <div class="accordion" id="accordion{{ tab }}">

                {% if tab == tabs %}
                  {% set accordion_range.value = number_of_accordions_in_last_tab + 1 %}
                {% endif %}

                {% for accordion in range(accordion_range.value) %}
                  <div class="accordion-group">
                    <div class="accordion-heading">
                     <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion{{ tab }}"
                        href="#collapse{{ tab }}{{ accordion }}">Autonomous System range: {{ tab }}{{ accordion }}
                     </a>
                    </div>
                    <div id="collapse{{ tab }}{{ accordion }}" class="accordion-body collapse">
                      <div class="accordion-inner">
                        {% for autonomous_system in autonomousSystems %}
                          {% if (loop.index >= begin_accordion.value) and (loop.index < end_accordion.value)%}
                            <p>
                              {% if request.user.role == 'admin' %}
                                <a href="{{ request.route_url('topologiesAction', action='autonomousSystemEdit', id_topology = autonomous_system.id) }}">AS {{ autonomous_system.autonomous_system }}</a>
                              {% else %}
                                AS {{ autonomous_system.autonomous_system }}
                              {% endif %}
                            </p>
                          {% endif %}
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                  {% set begin_accordion.value = begin_accordion.value + 1000 %}
                  {% set end_accordion.value = end_accordion.value + 1000 %}
                {% endfor %}

              </div>
            </div>
          {% endfor %}
        </div>

      </div>
    </div>
  </div>

{% endblock contentDashboard %}